<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-tabs/paper-tab.html">
<link rel="import" href="../paper-tabs/paper-tabs.html">
<link rel="import" href="authlete-component-client-display.html">

<polymer-element name="authlete-component-client" attributes="locale json">

  <template>
    <link rel="stylesheet" href="authlete-component-client.css">

    <paper-tabs id="tabs" class="tabs" selected="basic" noink nobar>
      <paper-tab id="tabBasic" name="basic">Basic</paper-tab>
      <paper-tab id="tabAdvanced" name="advanced">Advanced</paper-tab>
    </paper-tabs>

    <authlete-component-client-display id="display" mode="basic" resources="{{resources}}" data="{{data}}" locale="{{locale}}"></authlete-component-client-display>
  </template>

  <!-- Authlete Parameter Definition -->
  <script src="authlete-component-client-resources_en.js"></script>
  <script src="authlete-component-client-resources_ja.js"></script>
  <script src="authlete-component-client-default-data.js"></script>

  <script>
    (function() {
      Polymer({

        ready: function () {
          this.setUpResources();
          this.setUpData();
          this.setUpDisplayMode();
        },

        setUpResources: function () {
          // Set the resource depending on the given locale information.
          switch (this.locale) {
            case "ja":
              this.resources = authlete_component_client_resources_ja;
              break;

            default:
              this.locale = "en";
              this.resources = authlete_component_client_resources_en;
              break;
          }
        },

        setUpData: function() {
          // Put the default data.
          this.data = authlete_component_client_default_data;

          // If the argument 'json' has a value.
          if (this.json)
          {
            try
            {
              // Parse it into an object and put it into the data.
              this.data = JSON.parse(json);
            }
            catch (e)
            {
              throw "The argument 'json' is invalid.";
            }
          }
        },

        setUpDisplayMode: function () {
          var that = this;

          // If the 'tabBasic' gets clicked, change the display mode to the "basic" mode.
          this.$.tabBasic.addEventListener("click", function () {
            if (that.$.display.mode !== "basic")
            {
              that.$.display.mode = "basic";
            }
          });

          // If the 'tabAdvanced' gets clicked, change the display mode to the "advanced" mode.
          this.$.tabAdvanced.addEventListener("click", function () {
            if (that.$.display.mode !== "advanced")
            {
              that.$.display.mode = "advanced";
            }
          });
        }

      });
    })();
  </script>

</polymer-element>